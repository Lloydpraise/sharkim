<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" href="images/icon%20logo.png">
  <title>Legal Policies - Sharkim Traders</title>
  
  <script src="https://cdn.tailwindcss.com/"></script>
  <script src="https://unpkg.com/@supabase/supabase-js"></script>
  
  <style>
    html, body { font-family: "Times New Roman", Times, serif, Arial, Helvetica, sans-serif; }
    /* Brand Colors */
    .brand-orange { color: #ea580c; }
    .bg-brand-orange { background-color: #ea580c; }
    .header-bg { background-color: #f3f4f6; }
    
    /* Loading Spinner */
    .loader {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #ea580c;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 50px auto;
    }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
  </style>
</head>
<body class="bg-gray-50 flex flex-col min-h-screen">

  <header class="header-bg py-3 shadow-sm">
    <div class="max-w-7xl mx-auto px-4 flex justify-between items-center">
      <a href="index.html">
        <img src="images/sharkim_gold_logo.png" alt="Sharkim Logo" class="h-12 object-contain">
      </a>
      <a href="index.html" class="text-sm font-bold text-gray-600 hover:text-[#ea580c] flex items-center gap-1">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" /></svg>
        Back to Shop
      </a>
    </div>
  </header>

  <main class="flex-grow max-w-4xl mx-auto w-full px-4 py-10">
    <div id="policy-container" class="bg-white p-8 md:p-12 rounded-xl shadow-sm border border-gray-100 min-h-[400px]">
        <div id="loader" class="loader"></div>
    </div>
  </main>

  <footer class="bg-gray-900 text-white pt-10 pb-5">
    <div class="max-w-7xl mx-auto px-4 text-center">
      <p class="text-gray-400 text-sm">&copy; 2026 Sharkim Traders. All rights reserved.</p>
    </div>
  </footer>

  <script>
    // 1. CONFIGURATION (Matches index.js)
    const SUPABASE_URL = 'https://ljxvxbjhkgoeygpyejkc.supabase.co/';
    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxqeHZ4Ympoa2dvZXlncHllamtjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc1ODE3MzMsImV4cCI6MjA4MzE1NzczM30.fBrwtnv89UHgjs523rKCODE5W4nfBmDsP0AUQ8NgBlU';
    const client = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    async function loadPolicy() {
        const params = new URLSearchParams(window.location.search);
        const policyId = params.get('id');
        const container = document.getElementById('policy-container');
        const loader = document.getElementById('loader');

        if (!policyId) {
            container.innerHTML = `
                <h1 class="text-3xl font-bold text-gray-800 mb-6">Legal Policies</h1>
                <ul class="space-y-3">
                    <li><a href="?id=shipping" class="text-[#ea580c] hover:underline font-medium">Shipping Policy</a></li>
                    <li><a href="?id=return" class="text-[#ea580c] hover:underline font-medium">Return Policy</a></li>
                    <li><a href="?id=terms" class="text-[#ea580c] hover:underline font-medium">Terms & Conditions</a></li>
                </ul>`;
            return;
        }

        try {
            const { data, error } = await client
                .from('site_policies')
                .select('*')
                .eq('id', policyId)
                .single();

            if (error || !data) {
                container.innerHTML = `<div class="text-center text-red-500 py-10">Policy not found.</div>`;
            } else {
                // Render Policy
                container.innerHTML = `
                    <h1 class="text-3xl md:text-4xl font-bold text-[#ea580c] mb-6 pb-4 border-b border-gray-100">
                        ${data.title}
                    </h1>
                    <div class="prose prose-orange max-w-none text-gray-600 leading-relaxed">
                        ${data.content}
                    </div>
                    <div class="mt-8 pt-6 border-t border-gray-100 text-xs text-gray-400">
                        Last Updated: ${new Date(data.last_updated).toLocaleDateString()}
                    </div>
                `;
            }
        } catch (err) {
            console.error(err);
            container.innerHTML = `<div class="text-center text-red-500">An error occurred loading the policy.</div>`;
        }
    }

    loadPolicy();
  </script>
</body>
</html>